% ===========================================
%  weltbuch.sty – E-Book-Stil (Kindle/EPUB)
%  Autor: Dipl.-Ing. (FH) Christian Weilharter
%  Version: v2.1 – 2025-10-09 (E-Book: mit Kapitelnummern, ohne Seitenzahlen)
% ===========================================

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{weltbuch}[2025/10/09 v2.1 Weltbuch-Stil (E-Book)]

% -------------------------------------------------
% Sprache & Typografie
% -------------------------------------------------
\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}
\RequirePackage[ngerman]{babel}
\RequirePackage{lmodern}
\RequirePackage[protrusion=true,expansion=true]{microtype}
\RequirePackage[hidelinks]{hyperref}
\setlength{\emergencystretch}{3em}

% -------------------------------------------------
% Absatzformatierung für Reflow/E-Book
% -------------------------------------------------
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.7em}

% -------------------------------------------------
% Mathe & Physik
% -------------------------------------------------
\RequirePackage{amsmath,amssymb}
\RequirePackage{physics}
\RequirePackage{siunitx}
\RequirePackage{slashed}

% -------------------------------------------------
% Grafiken (schlank für E-Books)
% -------------------------------------------------
\RequirePackage{graphicx}
\newcommand{\ebookimage}[2][]{%
	\begin{center}\includegraphics[width=\linewidth,#1]{#2}\end{center}%
}

% -------------------------------------------------
% Tabellen, Floats, Captions
% -------------------------------------------------
\RequirePackage{float}
\RequirePackage{booktabs}
\RequirePackage{caption}

% -------------------------------------------------
% Farben & Boxen
% -------------------------------------------------
\RequirePackage{xcolor}
\RequirePackage[most]{tcolorbox}
\RequirePackage{csquotes}
\RequirePackage{etoolbox}
\tcbset{breakable}
\AtBeginEnvironment{tcolorbox}{\pretocmd{\tcbtitletext}{\ignorespaces}{}{}}

% -------------------------------------------------
% Inhaltsverzeichnis – mit Nummern, ohne Seitenzahlen
% -------------------------------------------------
\setcounter{tocdepth}{3}

\makeatletter
% Seitenzahlen im ToC entfernen (funktioniert mit und ohne hyperref)
\@ifpackageloaded{hyperref}{%
	\let\H@oldcontentsline\contentsline
	\renewcommand*\contentsline[4]{\H@oldcontentsline{#1}{#2}{}{#4}}%
}{%
	\let\oldcontentsline\contentsline
	\renewcommand*\contentsline[3]{\oldcontentsline{#1}{#2}{}}%
}

% Punktleader entfernen (keine "..." zwischen Text und Seitenzahl)
\renewcommand*\@dotsep{10000}

% Einzüge (Nummern bleiben erhalten)
\renewcommand*\l@chapter{\@dottedtocline{0}{0pt}{2.5em}}
\renewcommand*\l@section{\@dottedtocline{1}{1.5em}{2.5em}}
\renewcommand*\l@subsection{\@dottedtocline{2}{3em}{3em}}
\makeatother

% -------------------------------------------------
% Kopf-/Fußzeilen (keine Seitenzahlen auf Seiten)
% -------------------------------------------------
\makeatletter
\pagestyle{empty}
\let\ps@plain\ps@empty
\makeatother

% -------------------------------------------------
% Nummerierungen (sichtbar im Text)
% -------------------------------------------------
\renewcommand*{\thechapter}{\Roman{chapter}}          % Kapitel: I, II, ...
\renewcommand*{\thesection}{\arabic{section}}         % Section: 1, 2, ...
\renewcommand*{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}

% -------------------------------------------------
% Index (nur \index{} erlauben)
% -------------------------------------------------
\RequirePackage{makeidx}
\makeindex

% -------------------------------------------------
% Literatur (BibLaTeX funktioniert im EPUB als Liste)
% -------------------------------------------------
\RequirePackage[backend=biber,style=numeric]{biblatex}
\addbibresource{bib/literatur.bib}

% -------------------------------------------------
% Box-Stile (leichtgewichtig, gut lesbar)
% -------------------------------------------------
\tcbset{physikbox/.style={  colback=blue!5!white,    colframe=blue!75!black,  fonttitle=\bfseries}}
\tcbset{mathebox/.style={   colback=green!5!white,   colframe=green!50!black, fonttitle=\bfseries}}
\tcbset{didaktikbox/.style={colback=yellow!5!white,  colframe=yellow!50!black,fonttitle=\bfseries}}
\tcbset{hypobox/.style={    colback=orange!5!white,  colframe=orange!75!black,fonttitle=\bfseries}}
\tcbset{hinweisbox/.style={ colback=gray!10!white,   colframe=black!40!black, fonttitle=\bfseries}}
\tcbset{historybox/.style={ colback=brown!5!white,   colframe=brown!60!black, fonttitle=\bfseries}}

% -------------------------------------------------
% Box-Makros (mit Label)
% -------------------------------------------------
\newcommand{\PhysikBox}[3]{%
	\begin{tcolorbox}[physikbox, title={#1}]
		\label{#2}
		\small #3
	\end{tcolorbox}
}
\newcommand{\MatheBox}[3]{%
	\begin{tcolorbox}[mathebox, title={#1}]
		\label{#2}
		\small #3
	\end{tcolorbox}
}
\newcommand{\DidaktikBox}[3]{%
	\begin{tcolorbox}[didaktikbox, title={#1}]
		\label{#2}
		\small #3
	\end{tcolorbox}
}
\newcommand{\HinweisBox}[3]{%
	\begin{tcolorbox}[hinweisbox, title={#1}]
		\label{#2}
		\small #3
	\end{tcolorbox}
}
\newcommand{\HypoBox}[3]{%
	\begin{tcolorbox}[hypobox, title={#1}]
		\label{#2}
		\small #3
	\end{tcolorbox}
}
\newcommand{\HistoryBox}[3]{%
	\begin{tcolorbox}[historybox, title={#1}]
		\label{#2}
		\small #3
	\end{tcolorbox}
}

\endinput
